% !TeX root = ../main-presentation.tex
\section{Operational semantics}

\begin{frame}
    \frametitle{Doing something useful}

    \centering

    \LARGE
    Suppose we have two circuits \\
    with the same denotation
    \normalsize

    \vspace{2em}

    \(
    \left\llbracket\dsptikzfig{strings/category/f}[box=f,colour=seq]\right\rrbracket
    =
    \left\llbracket\dsptikzfig{strings/category/f}[box=g,colour=seq]\right\rrbracket
    \)

    \vspace{2em}

    \LARGE
    \await
    What does this tell us about the \\
    \alert{structure} of these circuits?

\end{frame}
\begin{frame}
    \frametitle{Reducing it down}

    \await

    \centering
    \scalebox{4}{\textbf{Operational}}

    \scalebox{4}{\textbf{semantics}}

\end{frame}
\begin{frame}
    \frametitle{Reducing it down}

    \centering
    \LARGE

    We want to find a set of \\ \alert{reductions} for digital circuits


    \await
    We want to reduce circuits to their outputs \alert{syntactically}
    in a \alert{step-by-step} manner

\end{frame}
\begin{frame}
    \frametitle{Going global}

    \centering

    \dsptikzfig{strings/category/f}[box=f,colour=seq]
    \await
    \Large=\normalsize
    \dsptikzfig{circuits/productivity/trace-delay}[core=\hat{f},state=\listvar{v}]

    \vspace{1em}
    \Large
    by moving boxes and wires around
\end{frame}

\begin{frame}
    \frametitle{Going global}

    \centering
    \Large

    \await

    \normalsize
    \begin{gather*}
        \dsptikzfig{circuits/components/waveforms/register}
        \coloneqq
        \dsptikzfig{circuits/components/waveforms/register-shorthand}
        \qquad
        \Large
        \text{\alert{`Register'}}
    \end{gather*}

    \vspace{1em}

    \await

    \dsptikzfig{circuits/productivity/trace-delay}[core=f,state=\listvar{v}]
    \Large\(\reduction\)\normalsize
    \dsptikzfig{circuits/productivity/mealy-rule}[core=\hat{f}]

    \await

    \dsptikzfig{strings/category/f}[box=f,colour=seq]
    \Large\(\reductions\)\normalsize
    \dsptikzfig{circuits/productivity/pre-mealy-form}[core=\hat{f},state=\listvar{s}]
    \Large\(\reductions\)\normalsize
    \dsptikzfig{circuits/productivity/mealy-form}[core=\tilde{f},state=\overline{s}]

\end{frame}
\begin{frame}
    \frametitle{What is the goal}

    \centering

    \await
    \Large
    We want to compute the \alert{outputs} of circuits given some \alert{inputs}
    \normalsize

    \begin{gather*}
        \dsptikzfig{circuits/productivity/productive-goal-lhs}[box=f]
        \reductions
        \dsptikzfig{circuits/productivity/productive-goal-rhs}[box=g]
    \end{gather*}

    \await

    \vspace{1em}

    \Large

    How does a circuit \alert{process} a value?

\end{frame}
\begin{frame}
    \frametitle{Reducing values}

    \begin{gather*}
        \dsptikzfig{circuits/axioms/gate-lhs}
        \reduction
        \dsptikzfig{circuits/axioms/gate-rhs}
        \qquad
        \dsptikzfig{circuits/axioms/fork-lhs}
        \reduction
        \dsptikzfig{circuits/axioms/fork-rhs}
        \\[0.5em]
        \dsptikzfig{circuits/axioms/join-lhs}
        \reduction
        \dsptikzfig{circuits/axioms/join-rhs}
        \qquad
        \dsptikzfig{circuits/axioms/stub-lhs}
        \reduction
        \dsptikzfig{strings/monoidal/empty}
    \end{gather*}

    \await
    \vspace{1em}
    \Large

    \begin{lemma}
        For every
        \dsptikzfig{strings/category/f}[box=f,colour=comb]
        there exists
        \dsptikzfig{circuits/components/values/vs}[val=\listvar{w}]
        s.t.
        \dsptikzfig{circuits/components/circuits/f-applied}[box=f,colour=comb]
        \(\reductions\)
        \dsptikzfig{circuits/components/values/vs}[val=\listvar{w}].
    \end{lemma}

\end{frame}


\begin{frame}
    \frametitle{Catching the jet stream}

    \Large

    What about \alert{delays}?

    \normalsize

    \begin{gather*}
        \visible<\iftoggle{static}{1}{2-}>{\dsptikzfig{circuits/axioms/generalised-streaming-lhs}[box=f]}
        \visible<\iftoggle{static}{1}{3-}>{\coloneqq}
        \visible<\iftoggle{static}{1}{3-}>{\dsptikzfig{circuits/axioms/generalised-streaming-lhs-verbose}[box=f]}
        \visible<\iftoggle{static}{1}{4-}>{\reduction}
        \visible<\iftoggle{static}{1}{4-}>{\dsptikzfig{circuits/axioms/generalised-streaming-rhs}[box=f]}
        \qquad
        \visible<\iftoggle{static}{1}{5-}>{\text{\alert{'Streaming'}}}
    \end{gather*}
\end{frame}

\begin{frame}
    \frametitle{Catching the jet stream}

    \vspace{-2em}

    \begin{gather*}
        \visible<\iftoggle{static}{1}{2-}>{\dsptikzfig{circuits/productivity/productive-goal-lhs}[box=f]}
        \visible<\iftoggle{static}{1}{3-}>{\reduction}
        \visible<\iftoggle{static}{1}{3-}>{\dsptikzfig{circuits/productivity/mealy-form-applied}[core=\hat{f}]}
        \visible<\iftoggle{static}{1}{4-}>{\reduction}
        \visible<\iftoggle{static}{1}{4-}>{\dsptikzfig{circuits/productivity/mealy-form-streamed}[core=\hat{f}]}
        \\[0.75em]
        \visible<\iftoggle{static}{1}{5-}>{\reduction}
        \visible<\iftoggle{static}{1}{5-}>{\dsptikzfig{circuits/productivity/mealy-form-instant}[core=\hat{f}]}
        \visible<\iftoggle{static}{1}{6-}>{\reduction}
        \visible<\iftoggle{static}{1}{6-}>{\dsptikzfig{circuits/productivity/mealy-form-instant-registers}[core=\hat{f}]}
        \\[0.75em]
        \visible<\iftoggle{static}{1}{7-}>{\reduction}
        \visible<\iftoggle{static}{1}{7-}>{\dsptikzfig{circuits/productivity/mealy-form-produced}[core=\hat{f}]}
        \visible<\iftoggle{static}{1}{8-}>{\coloneqq}
        \visible<\iftoggle{static}{1}{8-}>{\dsptikzfig{circuits/productivity/productive-goal-rhs}[box=g]}
    \end{gather*}
\end{frame}

\begin{frame}
    \frametitle{Observe this}

    \centering
    \LARGE

    When are two circuits \alert{observationally equivalent}?

    \await

    Circuits have \alert{finitely many states}...

    \vspace{1em}

    \dsptikzfig{circuits/productivity/mealy-form}[core=f,state=s]
    \quad
    \dsptikzfig{circuits/productivity/mealy-form}[core=f,state=t]
    \quad
    \dsptikzfig{circuits/productivity/mealy-form}[core=f,state=u]
    \quad
    \(\cdots\)

    Maximum number of states: \(|\values|^{\text{number of delays}}\)

\end{frame}
\begin{frame}
    \frametitle{Observe this}

    \centering
    \Large

    \(
    \dsptikzfig{strings/category/f}[colour=seq]
    \sim
    \dsptikzfig{strings/category/f}[colour=seq,box=g]
    \)

    \qquad

    Two circuits are \alert{observationally equivalent} if the
    reduction procedure creates the same outputs for all inputs of length
    \(|\values|^{\text{max number of delays}} + 1\).

\end{frame}

\begin{frame}
    \frametitle{Observe this}

    \centering
    \Large

    \(
    \dsptikzfig{strings/category/f}[colour=seq]
    \approx
    \dsptikzfig{strings/category/f}[colour=seq,box=g]
    \Leftrightarrow
    \dsptikzfig{strings/category/f}[colour=seq]
    \sim
    \dsptikzfig{strings/category/f}[colour=seq,box=g]
    \)

    \await

    \vspace{1em}

    \LARGE
    Denotational semantics \(\cong\) Operational semantics

\end{frame}